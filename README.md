# cve-alert-manager



## Description

suit to pull CVE incidents from different sources (for example [CERT-Bund](https://www.cert-bund.de/wid)), to normalize them and store them in a database in order to provide an unified REST-API to manage CVE alerts.
all components are written in golang.

## Features

### CVE Alert Fetcher (cve-alert-fetcher)

- fetches CVE alerts from various sources (currently only "cert-bund")
- normalizing all received alerts and put them in the database
- parameters (such as access data) can be specified on command line and in config file
- features for source "cert-bund":
  - retrieves PGP-signed multipart-MIME-mail via POP3
  - check the PGP signature via public key 

### CVE Alert Rest API (cve-alert-restapi)

- option to search and list cve alerts
- option to filter certain categories
- option to add, change or delete comments
- option to list a specific comment
- option to import,add and export filter
- configurable search filters



## Architexture and Components

Here is a graphic that shows the components and the architexture of the cve-alert-manager

![cve-alert-manager](https://user-images.githubusercontent.com/60655329/77313323-edca2980-6d03-11ea-91fd-add1a644eae6.png)


## Requirements

You need to register to the "Warning and Information Service of [CERT-Bund](https://www.cert-bund.de/wid) and subscribe to desired messages 



## Installation

```
go get github.com/inexio/cve-alert-manager
```

or

```
git clone https://github.com:inexio/cve-alert-manager.git
```



## Setup

After installing the suit you have to either declare a path to your config file or set certain environment variables for the fetcher to work

These can be set as follows:

Default config file path:

```
$HOME/go/src/cve-alert-manager/config
```

Default config file name:

```
cve-alert-manager.yaml
```

Change config file path

```go
func initConfig() {
  ...
    // Here is where you can change the config file path 
		//Â Just change the file path string 
		viper.AddConfigPath(home+"/go/src/cve-alert-manager/config")
		viper.SetConfigName("cve-alert-fetcher")
  ...
}
```

## Usage

### How to run cve-alert-fetcher

First change directory to cve-alert-fetcher:

```
cd go/src/cve-alert-manager/cve-alert-fetcher
```



Second run main (and maybe set args and flags)

```
go run main.go 
```



 set a different log-level / treshold (default info):

```
go run main.go --log-level error #Only show error 
go run main.go --log-level debug #Only show debug
```



or set a different souce (default "cert-bund"):

```
go run main.go --source nist
```



### How to run cve-alert-restapi

First start change your directory to cve-alert-restapi

```
cd go/src/cve-alert-manager/cve-alert-restapi
```

Then run the echo framework on a port you want

```
go run main-go --port 1323 #Run Framework on a specific port
```

Now create a new tab on your shell and log in to your server where your framework is running

```
curl -X GET http://localhost:1323/cvecases
#This request gets all CveCases that are saved in the database
```

Full documentation of our api is available at [swaggerhub](https://app.swaggerhub.com/apis-docs/TheFireMike/cve-alert-manager/)


## cve-alert-fetcher email parsing for cert-bund

Here is a graphic that shows how cve-alert-fetcher parse emails from cert-bund

![cve-alert-fetcher](https://user-images.githubusercontent.com/60655329/77313384-118d6f80-6d04-11ea-9549-2a6a70e460ed.png)


## Relationship between filter_categories and case_categories

Here is a graphic that shows the relationship between these two Database tables
![cve-alert-database](https://user-images.githubusercontent.com/60655329/77313515-4e596680-6d04-11ea-980a-b101ae91fcb2.png)


## Getting Help

If there are any problems. or something does not work as intended, open an issue on GitHub.



## Contribution

Contribution to the project are welcome.

We are looking forward to your bug reports, suggestions and fixes.

If you want to make any contributions make sure your go reports match up with our projects score **A+**.

When you contribute make sure you code is confirm to the **uber-go** coding style.
